この AWS アーキテクチャ構成図を書き起こします。

## 全体構成

**AWS Cloud環境内のVPCで構成された高可用性Webアプリケーションシステム**

## ネットワーク層

### VPC構成
- **2つのアベイラビリティゾーン (AZ)** で冗長化構成
- 各AZに以下のサブネット配置:
  - **Public subnet** (パブリックサブネット)
  - **Private subnet** (プライベートサブネット) × 2層

### インターネット接続
- **ユーザー** → HTTPS通信 → **ALB (Application Load Balancer)**
- 各AZの Public subnet に **NAT ゲートウェイ** を配置

## アプリケーション層

### ロードバランシング
- **ALB**: Public subnet に配置
  - HTTPS通信を受信
  - HTTP通信でバックエンドへ転送

### Webアプリケーション層
- **ACM証明書**: ALBでのHTTPS終端に使用
- **EC2インスタンス** × 2 (各AZ)
  - Private subnet (上位層) に配置
  - **Auto scaling** グループで管理
  - HTTP通信でALBから受信

## データベース層

### RDS Aurora MySQL クラスター
- Private subnet (下位層) に配置
- **Aurora クラスター構成**:
  - **Master instance** (クラスターエンドポイント): 左側AZ
  - **Read replica** (リーダーエンドポイント): 右側AZ
- EC2インスタンスから接続

## 外部サービス・管理

### ストレージ
- **S3**: ALBアクセスログ保存用、教材画像保存用

### 管理・監視
- **Systems Manager**: EC2接続用
- **CloudWatch**: メトリックとアラームで監視

## 通信フロー

1. ユーザー → HTTPS通信 → ALB (Public subnet)
2. ALB → HTTP通信 → EC2 (Private subnet)
3. EC2 → データベース接続 → RDS Aurora MySQL (Private subnet)
4. EC2 → NAT ゲートウェイ経由でインターネットへ外部通信可能

この構成は、高可用性・スケーラビリティ・セキュリティを考慮した典型的な3層Webアプリケーションアーキテクチャです。